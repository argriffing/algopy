<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>ALGOPY, Algorithmic Differentiation in Python &mdash; algopy v documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '#',
        VERSION:     '',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="algopy v documentation" href="#" />
    <link rel="next" title="Getting Started:" href="getting_started.html" /> 
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="getting_started.html" title="Getting Started:"
             accesskey="N">next</a> |</li>
        <li><a href="#">algopy v documentation</a> &raquo;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  <div class="section" id="algopy-algorithmic-differentiation-in-python">
<h1>ALGOPY, Algorithmic Differentiation in Python<a class="headerlink" href="#algopy-algorithmic-differentiation-in-python" title="Permalink to this headline">¶</a></h1>
<p>Contents:</p>
<ul>
<li class="toctree-l1"><a class="reference external" href="getting_started.html">Getting Started:</a></li>
</ul>
<div class="section" id="what-is-algopy">
<h2>What is ALGOPY?<a class="headerlink" href="#what-is-algopy" title="Permalink to this headline">¶</a></h2>
<p>The purpose of ALGOPY is the evaluation of higher-order derivatives
in the forward and reverse mode of Algorithmic Differentiation (AD). Particular
focus are functions that contain numerical linear algebra functions as
they often appear in statistically motivated functions.</p>
</div>
<div class="section" id="illustrative-example">
<h2>Illustrative Example:<a class="headerlink" href="#illustrative-example" title="Permalink to this headline">¶</a></h2>
<p>Consider the situation where the entries of a matrix <img class="math" src="_images/math/e66be7dcf3d44952970a2a268c9927e0d6921b41.png" alt="A \equiv A(x)\in \mathbb R^{M \times N}"/> is computed
by a computer program, where <img class="math" src="_images/math/38b839ec63cd92d8ab847dc8226d5ece53b0ac24.png" alt="x \in \mathbb R^{N_x}"/>. To give an explicit example we consider</p>
<div class="math">
<p><img src="_images/math/824c28accd01164251099c246df72269d0ab26de.png" alt="A(x) = \begin{pmatrix}
\sin(x_1)^2 + x_2 &amp; x_1 \\
e^{x_1/x_2} &amp; x_3 \\
\log(x_1 + x_3*x_2) &amp; 0 \\
\end{pmatrix}" /></p>
</div><p>In a second step it is desired to compute</p>
<div class="math">
<p><img src="_images/math/2f3fc4b9270e5ce1391a629f96ae39b3f14575f4.png" alt="\Phi(x) = \max( \lambda( (A(x)^T A(x))^{-1}) \;," /></p>
</div><p>where <img class="math" src="_images/math/ca2ddc5a62b85bb4781e4daec0bb60ca3c2bc8c3.png" alt="\lambda(C)"/> computes all eigenvalues of the matrix <img class="math" src="_images/math/c3355896da590fc491a10150a50416687626d7cc.png" alt="C"/> and
<img class="math" src="_images/math/c3231b2155b80f8a5b7e7116c5035c21266b2cd6.png" alt="\max"/> returns the largest of the eigenvalues. The matrix inversion is not
really necessary since one could as well invert the smallest eigenvalue. It is
used here simply to make the point that its easy to concatenate matrix functions
together.</p>
<p>We are interested in the numerical value of the gradient</p>
<div class="math">
<p><img src="_images/math/de46f2f8335a078eace5bffe751cb04c97effb86.png" alt="\nabla_x \Phi(x)" /></p>
</div><p>at <img class="math" src="_images/math/92723e2c965082c52d95b71c879e032d3b5d7912.png" alt="x=(3,5,7)^T"/>. At first we look at the forward mode of AD. E.g. we want to compute
<img class="math" src="_images/math/6f5ef1923f415cbf74fa20c5b7f82cefbb7a19fe.png" alt="\frac{\partial \Phi}{\partial x_1}"/>.</p>
<p>The corresponding code is:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span>
<span class="kn">from</span> <span class="nn">algopy</span> <span class="kn">import</span> <span class="n">UTPM</span><span class="p">,</span> <span class="n">eigh</span><span class="p">,</span> <span class="n">inv</span><span class="p">,</span> <span class="n">dot</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">UTPM</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">UTPM</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

<span class="k">print</span> <span class="s">&#39;A =&#39;</span><span class="p">,</span> <span class="n">A</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">A</span><span class="p">)))[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>

<span class="k">print</span> <span class="s">&#39;Phi(x) = &#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="k">print</span> <span class="s">&#39;d/dx_1 Phi(x) = &#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
</pre></div>
</div>
<p>Running the code yields:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">algopy</span> <span class="kn">import</span> <span class="n">UTPM</span><span class="p">,</span> <span class="n">eigh</span><span class="p">,</span> <span class="n">inv</span><span class="p">,</span> <span class="n">dot</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">UTPM</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">7</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span> <span class="o">=</span> <span class="n">UTPM</span><span class="p">(</span><span class="n">numpy</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">A</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">numpy</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">*</span><span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&#39;A =&#39;</span><span class="p">,</span> <span class="n">A</span>
<span class="go">A = [[[[ 5.01991486  3.        ]</span>
<span class="go">   [ 1.8221188   7.        ]</span>
<span class="go">   [ 3.63758616  0.        ]]]</span>


<span class="go"> [[[-0.2794155   1.        ]</span>
<span class="go">   [ 0.36442376  0.        ]</span>
<span class="go">   [ 0.02631579  0.        ]]]]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">eigh</span><span class="p">(</span><span class="n">inv</span><span class="p">(</span><span class="n">dot</span><span class="p">(</span><span class="n">A</span><span class="o">.</span><span class="n">T</span><span class="p">,</span> <span class="n">A</span><span class="p">)))[</span><span class="mi">0</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&#39;Phi(x) = &#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="go">Phi(x) =  [ 0.04784897]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">print</span> <span class="s">&#39;d/dx_1 Phi(x) = &#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="go">d/dx_1 Phi(x) =  [ 0.01173805]</span>
</pre></div>
</div>
<p>The output of <cite>print &#8216;A =&#8217;, A</cite> is the contents of <cite>A.data</cite> with shape
<cite>A.data.shape = (2,1,3,2)</cite>. The first block corresponds to <cite>A.data[0]</cite>
and is simply the normal function evaluation. In the block <cite>A.data[1]</cite>
one has the partial derivatives <img class="math" src="_images/math/d99fd1c6e81023e3cd76e9c201f43f1792ad2575.png" alt="\frac{\partial A}{\partial x_1}"/>.
Similarly for <cite>y.data[0]</cite> which is the normal function evaluation and
<cite>y.data[1]</cite> is the partial derivative <img class="math" src="_images/math/6f5ef1923f415cbf74fa20c5b7f82cefbb7a19fe.png" alt="\frac{\partial \Phi}{\partial x_1}"/>.</p>
</div>
<div class="section" id="rationale">
<h2>Rationale:<a class="headerlink" href="#rationale" title="Permalink to this headline">¶</a></h2>
<p>The central idea of ALGOPY is the computation on Taylor polynomials with scalar
coefficients and with matrix coefficients. These algorithms are primarily used for
Algorithmic Differentiation (AD)in the forward and reverse mode.</p>
<p>The focus are univariate Taylor polynomials over matrices (UTPM),implemented in
the class <cite>algopy.utpm.UTPM</cite>.</p>
<p>To allow the use of the reverse mode of AD a simple code tracer has been implemented in
<cite>algopy.tracer</cite>. The idea is to record the computation procedure in a datastructure s.t.
the control flow sequence can walked in reverse order.</p>
<p>ALGOPY is a research prototype where, to the best of authors&#8217;
knowledge, some algorithms are implemented that cannot be found elsewhere.</p>
<p>Most of ALGOPY is implemented in pure Python. However, some submodules are implemented
in pure C. For these submodules Python bindings using ctypes are provided.</p>
<p>The algorithms are quite well-tested and have been successfully used.
However, since the user-base is currently quite small, it is possible that bugs
may still be persistent.
Also, not all submodules of ALGOPY are feature complete. The most important parts
<cite>algopy.tracer</cite> and <cite>algopy.upt.UTPM</cite> are however fairly complete.</p>
</div>
</div>
<div class="section" id="indices-and-tables">
<h1>Indices and tables<a class="headerlink" href="#indices-and-tables" title="Permalink to this headline">¶</a></h1>
<ul class="simple">
<li><a class="reference external" href="genindex.html"><em>Index</em></a></li>
<li><a class="reference external" href="modindex.html"><em>Module Index</em></a></li>
<li><a class="reference external" href="search.html"><em>Search Page</em></a></li>
</ul>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="#">Table Of Contents</a></h3>
            <ul>
<li><a class="reference external" href="#">ALGOPY, Algorithmic Differentiation in Python</a><ul>
<li><a class="reference external" href="#what-is-algopy">What is ALGOPY?</a></li>
<li><a class="reference external" href="#illustrative-example">Illustrative Example:</a></li>
<li><a class="reference external" href="#rationale">Rationale:</a></li>
</ul>
</li>
<li><a class="reference external" href="#indices-and-tables">Indices and tables</a></li>
</ul>

            <h4>Next topic</h4>
            <p class="topless"><a href="getting_started.html"
                                  title="next chapter">Getting Started:</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/index.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
          <div id="searchbox" style="display: none">
            <h3>Quick search</h3>
              <form class="search" action="search.html" method="get">
                <input type="text" name="q" size="18" />
                <input type="submit" value="Go" />
                <input type="hidden" name="check_keywords" value="yes" />
                <input type="hidden" name="area" value="default" />
              </form>
              <p class="searchtip" style="font-size: 90%">
              Enter search terms or a module, class or function name.
              </p>
          </div>
          <script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="getting_started.html" title="Getting Started:"
             >next</a> |</li>
        <li><a href="#">algopy v documentation</a> &raquo;</li> 
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2010, Sebastian F. Walter.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.4.
    </div>
  </body>
</html>